% filepath: test_hdi_plot_documentation.tex
\documentclass[a4paper,12pt,dvipdfmx]{jlreq}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{bm}
\usepackage{physics}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows, positioning, fit, backgrounds, calc, patterns}
\usepackage{algorithm2e}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{tcolorbox}
\usepackage{listings}
\usepackage{siunitx}
\usepackage{multicol}

% ã‚«ãƒ©ãƒ¼ãƒœãƒƒã‚¯ã‚¹è¨­å®š
\newtcolorbox{keypoint}{colback=blue!5!white,colframe=blue!75!black,title=Key Point}
\newtcolorbox{warning}{colback=red!5!white,colframe=red!75!black,title=æ³¨æ„}
\newtcolorbox{definition}{colback=green!5!white,colframe=green!50!black,title=å®šç¾©}
\newtcolorbox{diagnostic}{colback=orange!5!white,colframe=orange!75!black,title=è¨ºæ–­é …ç›®}

\lstset{
    basicstyle=\footnotesize\ttfamily,
    keywordstyle=\color{blue},
    commentstyle=\color{gray},
    breaklines=true,
    frame=single
}

\title{\vspace{-2cm}
\textbf{test\_hdi\_plot.py ç†è§£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ}\\
\large HDIä¿¡é ¼åŒºé–“ãƒ—ãƒ­ãƒƒãƒˆã®è¨ºæ–­ãƒ„ãƒ¼ãƒ«
}
\author{ç‰©ç†å·¥å­¦å°‚æ”» ä¿®å£«è«–æ–‡è§£æç”¨æ•™æ}
\date{2026å¹´1æœˆç‰ˆ}

\begin{document}
\maketitle

\tableofcontents
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{ã¯ã˜ã‚ã«ï¼šã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç›®çš„}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{keypoint}
ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€ãƒ™ã‚¤ã‚ºæ¨å®šçµæœã‹ã‚‰è¨ˆç®—ã•ã‚Œã‚‹\textbf{HDIï¼ˆHighest Density Intervalï¼‰ä¿¡é ¼åŒºé–“}ãŒ
æ­£ã—ãè¨ˆç®—ãƒ»æç”»ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’è¨ºæ–­ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
é€éã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ä¸ç¢ºã‹ã•ã‚’å¯è¦–åŒ–ã™ã‚‹éš›ã®å•é¡Œã‚’ç‰¹å®šã—ã¾ã™ã€‚
\end{keypoint}

\subsection{èƒŒæ™¯ï¼šãªãœã“ã®ãƒ„ãƒ¼ãƒ«ãŒå¿…è¦ã‹ï¼Ÿ}

ãƒ™ã‚¤ã‚ºæ¨å®šã®é‡è¦ãªåˆ©ç‚¹ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã ã‘ã§ãªã\textbf{äºˆæ¸¬ã®ä¸ç¢ºã‹ã•}ã‚‚å®šé‡åŒ–ã§ãã‚‹ã“ã¨ã§ã™ã€‚
ã—ã‹ã—ã€ä»¥ä¸‹ã®å•é¡ŒãŒç™ºç”Ÿã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼š

\begin{enumerate}
    \item HDIåŒºé–“ã®å¹…ãŒæ¥µç«¯ã«ç‹­ãã€å¯è¦–åŒ–ã§ããªã„
    \item äº‹å¾Œåˆ†å¸ƒã®åˆ†æ•£ãŒå°ã•ã™ãã¦ã€ä¿¡é ¼åŒºé–“ãŒæ„å‘³ã‚’ãªã•ãªã„
    \item ãƒ—ãƒ­ãƒƒãƒˆã®ç·šãŒé‡ãªã£ã¦å¢ƒç•Œç·šãŒè¦‹ãˆãªã„
\end{enumerate}

\subsection{ä½¿ç”¨æ–¹æ³•}

\begin{lstlisting}[language=bash]
python test_hdi_plot.py <çµæœãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª>

# ä¾‹:
python test_hdi_plot.py bayesian_results_v6_informed_HB_20260108_013540
\end{lstlisting}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{HDIï¼ˆHighest Density Intervalï¼‰ã¨ã¯}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{å®šç¾©}

\begin{definition}
\textbf{HDIï¼ˆHighest Density Intervalï¼‰}ã¯ã€äº‹å¾Œåˆ†å¸ƒã«ãŠã„ã¦ç¢ºç‡å¯†åº¦ãŒæœ€ã‚‚é«˜ã„é ˜åŸŸã‚’
å›²ã‚€ä¿¡é ¼åŒºé–“ã§ã™ã€‚95\% HDIã¯ã€äº‹å¾Œåˆ†å¸ƒã®95\%ã®ç¢ºç‡è³ªé‡ã‚’å«ã‚€æœ€å°å¹…ã®åŒºé–“ã§ã™ã€‚
\end{definition}

HDIã¯å¾“æ¥ã®\textbf{ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«åŒºé–“}ï¼ˆ2.5\%ã€œ97.5\%ï¼‰ã¨é¡ä¼¼ã—ã¦ã„ã¾ã™ãŒã€
éå¯¾ç§°ãªåˆ†å¸ƒã§ã¯ç•°ãªã‚‹çµæœã‚’ä¸ãˆã¾ã™ã€‚

\begin{figure}[h]
\centering
\begin{tikzpicture}[scale=0.85]
% å¯¾ç§°åˆ†å¸ƒ
\begin{scope}
    \draw[->] (0,0) -- (6,0) node[right] {$\theta$};
    \draw[->] (0,0) -- (0,3.5) node[above] {$P(\theta)$};
    
    % æ­£è¦åˆ†å¸ƒ
    \draw[thick, blue, domain=0.5:5.5, samples=50] 
        plot (\x, {3*exp(-(\x-3)*(\x-3)/0.8)});
    
    % HDIåŒºé–“
    \fill[blue!20, domain=1.3:4.7, samples=50] 
        (1.3,0) -- plot (\x, {3*exp(-(\x-3)*(\x-3)/0.8)}) -- (4.7,0) -- cycle;
    
    \draw[<->, thick, red] (1.3,0.2) -- (4.7,0.2);
    \node[below, red] at (3,0) {\small 95\% HDI};
    
    \node[below] at (3,-0.7) {\textbf{å¯¾ç§°åˆ†å¸ƒ}};
    \node[below] at (3,-1.2) {\small HDI = ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«åŒºé–“};
\end{scope}

% éå¯¾ç§°åˆ†å¸ƒ
\begin{scope}[xshift=8cm]
    \draw[->] (0,0) -- (6,0) node[right] {$\theta$};
    \draw[->] (0,0) -- (0,3.5) node[above] {$P(\theta)$};
    
    % æ­ªã‚“ã åˆ†å¸ƒ
    \draw[thick, blue, domain=0.5:5.5, samples=50] 
        plot (\x, {2.5*(\x-0.3)*exp(-0.7*(\x-0.3))});
    
    % HDIåŒºé–“
    \fill[blue!20, domain=0.8:3.8, samples=50] 
        (0.8,0) -- plot (\x, {2.5*(\x-0.3)*exp(-0.7*(\x-0.3))}) -- (3.8,0) -- cycle;
    
    \draw[<->, thick, red] (0.8,0.2) -- (3.8,0.2);
    \node[below, red] at (2.3,0) {\small 95\% HDI};
    
    \node[below] at (3,-0.7) {\textbf{éå¯¾ç§°åˆ†å¸ƒ}};
    \node[below] at (3,-1.2) {\small HDI $\neq$ ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«åŒºé–“};
\end{scope}
\end{tikzpicture}
\caption{å¯¾ç§°åˆ†å¸ƒã¨éå¯¾ç§°åˆ†å¸ƒã«ãŠã‘ã‚‹HDI}
\label{fig:hdi}
\end{figure}

\subsection{é€éã‚¹ãƒšã‚¯ãƒˆãƒ«ã¸ã®é©ç”¨}

å„å‘¨æ³¢æ•°ç‚¹$\omega_i$ã«ãŠã„ã¦ã€äº‹å¾Œã‚µãƒ³ãƒ—ãƒ«ã‹ã‚‰é€éç‡$T(\omega_i)$ã‚’è¨ˆç®—ã—ã€
ãã®åˆ†å¸ƒã®95\% HDIã‚’æ±‚ã‚ã¾ã™ï¼š

\begin{equation}
\boxed{
\text{95\% HDI at } \omega_i = \left[ T_{2.5\%}(\omega_i), \; T_{97.5\%}(\omega_i) \right]
}
\end{equation}

ã“ã“ã§$T_{p\%}$ã¯$p$ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«å€¤ã€‚

\subsection{HDIå¸¯ã®å¯è¦–åŒ–}

\begin{figure}[h]
\centering
\begin{tikzpicture}[scale=0.9]
    \draw[->] (0,0) -- (10,0) node[right] {Frequency [THz]};
    \draw[->] (0,0) -- (0,5) node[above] {Transmittance};
    
    % HDIå¸¯
    \fill[red!20] 
        plot[domain=0.5:9.5, samples=50] (\x, {3.5 + 0.8*sin(60*\x) + 0.3})
        -- plot[domain=9.5:0.5, samples=50] (\x, {3.5 + 0.8*sin(60*\x) - 0.3})
        -- cycle;
    
    % ä¸‹é™å¢ƒç•Œç·š
    \draw[dashed, red, thick] 
        plot[domain=0.5:9.5, samples=50] (\x, {3.5 + 0.8*sin(60*\x) - 0.3});
    
    % ä¸Šé™å¢ƒç•Œç·š
    \draw[dashed, red, thick] 
        plot[domain=0.5:9.5, samples=50] (\x, {3.5 + 0.8*sin(60*\x) + 0.3});
    
    % å¹³å‡ç·š
    \draw[thick, darkgray] 
        plot[domain=0.5:9.5, samples=50] (\x, {3.5 + 0.8*sin(60*\x)});
    
    % ãƒ‡ãƒ¼ã‚¿ç‚¹
    \foreach \x in {1,2,...,9} {
        \fill[blue] (\x, {3.5 + 0.8*sin(60*\x) + 0.15*rand}) circle (2pt);
    }
    
    % å‡¡ä¾‹
    \node[right] at (6,4.8) {\small \textcolor{blue}{â—} ãƒ‡ãƒ¼ã‚¿};
    \node[right] at (6,4.4) {\small â”€ äº‹å¾Œå¹³å‡};
    \node[right] at (6,4.0) {\small \textcolor{red}{- -} 95\% HDIå¢ƒç•Œ};
    \node[right] at (6,3.6) {\small \colorbox{red!20}{ã€€} HDIå¸¯};
\end{tikzpicture}
\caption{é€éã‚¹ãƒšã‚¯ãƒˆãƒ«ã®HDIå¯è¦–åŒ–}
\label{fig:hdi_spectrum}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{è¨ºæ–­é …ç›®}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{è¨ºæ–­ã•ã‚Œã‚‹é …ç›®}

\begin{table}[h]
\centering
\caption{HDIè¨ºæ–­é …ç›®}
\begin{tabular}{lll}
\toprule
\textbf{é …ç›®} & \textbf{å¥å…¨ãªå€¤} & \textbf{å•é¡Œã¨ãªã‚‹å€¤} \\
\midrule
HDIå¹…ã®å¹³å‡ & $> 0.01$ & $< 0.001$ \\
HDIå¹…ã®æœ€å¤§ & $> 0.05$ & $< 0.01$ \\
æ¨™æº–åå·®ã®å¹³å‡ & $> 0.005$ & $< 0.001$ \\
\bottomrule
\end{tabular}
\end{table}

\subsection{å•é¡Œã®åŸå› ã¨å¯¾å‡¦}

\begin{diagnostic}
\textbf{HDIå¹…ãŒæ¥µç«¯ã«ç‹­ã„å ´åˆ}ï¼ˆå¹³å‡ $< 0.001$ï¼‰

åŸå› ï¼š
\begin{itemize}
    \item äº‹å‰åˆ†å¸ƒãŒç‹­ã™ãã‚‹ï¼ˆ$\sigma$ãŒå°ã•ã„ï¼‰
    \item ãƒ‡ãƒ¼ã‚¿ã®æƒ…å ±é‡ãŒå¼·ã™ãã‚‹ï¼ˆéåº¦ã«åˆ¶ç´„ã•ã‚Œã‚‹ï¼‰
    \item ã‚µãƒ³ãƒ—ãƒ«æ•°ãŒå°‘ãªãã€åˆ†æ•£ãŒéå°è©•ä¾¡ã•ã‚Œã¦ã„ã‚‹
\end{itemize}

å¯¾å‡¦æ³•ï¼š
\begin{itemize}
    \item äº‹å‰åˆ†å¸ƒã®$\sigma$ã‚’3ã€œ5å€ã«æ‹¡å¤§
    \item ã‚ˆã‚Šå¼±ã„æƒ…å ±çš„äº‹å‰åˆ†å¸ƒã‚’ä½¿ç”¨
    \item ã‚µãƒ³ãƒ—ãƒ«æ•°ã‚’å¢—ã‚„ã™ï¼ˆ100 $\to$ 500ã€œ1000ï¼‰
\end{itemize}
\end{diagnostic}

\begin{diagnostic}
\textbf{HDIå¢ƒç•Œç·šãŒè¦‹ãˆãªã„å ´åˆ}

åŸå› ï¼š
\begin{itemize}
    \item HDIå¹…ãŒå°ã•ãã€å¹³å‡ç·šã¨é‡ãªã£ã¦ã„ã‚‹
    \item ç·šã®å¤ªã•ï¼ˆlinewidthï¼‰ãŒç´°ã™ãã‚‹
    \item è‰²ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒä¸è¶³
\end{itemize}

å¯¾å‡¦æ³•ï¼š
\begin{itemize}
    \item linewidthã‚’2.0 $\to$ 3.0ã«å¢—åŠ 
    \item ç ´ç·šã‚¹ã‚¿ã‚¤ãƒ«ã‚’æ˜ç¢ºåŒ–
    \item è‰²ã‚’æ¿ƒãã™ã‚‹
\end{itemize}
\end{diagnostic}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
\centering
\begin{tikzpicture}[
    node distance=0.9cm,
    startstop/.style={rectangle, rounded corners, minimum width=3cm, minimum height=0.7cm, 
                      text centered, draw=black, fill=red!30},
    process/.style={rectangle, minimum width=4cm, minimum height=0.7cm, 
                    text centered, draw=black, fill=orange!30},
    io/.style={trapezium, trapezium left angle=70, trapezium right angle=110, 
               minimum width=2.5cm, minimum height=0.7cm, text centered, draw=black, fill=blue!30},
    arrow/.style={thick,->,>=stealth}
]

\node (start) [startstop] {é–‹å§‹};
\node (load) [io, below=of start] {ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ»ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿};
\node (sample) [process, below=of load] {äº‹å¾Œã‚µãƒ³ãƒ—ãƒ«å–å¾— (n=100)};
\node (param) [process, below=of sample] {ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿çµ±è¨ˆè¡¨ç¤º};
\node (calc) [process, below=of param] {å„ã‚µãƒ³ãƒ—ãƒ«ã§é€éã‚¹ãƒšã‚¯ãƒˆãƒ«è¨ˆç®—};
\node (stat) [process, below=of calc] {çµ±è¨ˆé‡è¨ˆç®— (å¹³å‡, SD, HDI)};
\node (diag) [process, below=of stat] {è¨ºæ–­åˆ¤å®š};
\node (plot) [io, below=of diag] {ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒƒãƒˆç”Ÿæˆ};
\node (end) [startstop, below=of plot] {çµ‚äº†};

\draw [arrow] (start) -- (load);
\draw [arrow] (load) -- (sample);
\draw [arrow] (sample) -- (param);
\draw [arrow] (param) -- (calc);
\draw [arrow] (calc) -- (stat);
\draw [arrow] (stat) -- (diag);
\draw [arrow] (diag) -- (plot);
\draw [arrow] (plot) -- (end);

% æ³¨é‡ˆ
\node[right=0.5cm of calc, align=left] {\small ãƒ«ãƒ¼ãƒ—å‡¦ç†\\(ã‚µãƒ³ãƒ—ãƒ«Ã—å‘¨æ³¢æ•°ç‚¹)};

\end{tikzpicture}
\caption{test\_hdi\_plot.pyã®å‡¦ç†ãƒ•ãƒ­ãƒ¼}
\label{fig:flow}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{é€éã‚¹ãƒšã‚¯ãƒˆãƒ«è¨ˆç®—}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{äº‹å¾Œã‚µãƒ³ãƒ—ãƒ«ã‹ã‚‰ã®è¨ˆç®—}

å„äº‹å¾Œã‚µãƒ³ãƒ—ãƒ«$s = 1, 2, \ldots, N_{\text{samples}}$ã«ã¤ã„ã¦ï¼š

\begin{algorithm}[H]
\SetAlgoLined
\KwIn{äº‹å¾Œã‚µãƒ³ãƒ—ãƒ« $\{\bm{\theta}^{(s)}\}$ã€å‘¨æ³¢æ•°é…åˆ— $\{\omega_i\}$}
\KwOut{é€éã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚µãƒ³ãƒ—ãƒ« $\{T^{(s)}(\omega_i)\}$}

\For{$s = 1$ \KwTo $N_{\text{samples}}$}{
    ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æŠ½å‡º: $g^{(s)}, a^{(s)}, B_4^{(s)}, B_6^{(s)}, \varepsilon^{(s)}, \gamma^{(s)}$\;
    
    ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³æ§‹ç¯‰: $\hat{H}^{(s)} = \hat{H}_{\text{CF}}(B_4^{(s)}, B_6^{(s)}) + \hat{H}_{\text{Zee}}(g^{(s)}, B)$\;
    
    æ„Ÿå—ç‡è¨ˆç®—: $\chi^{(s)}(\omega) = \text{calculate\_susceptibility}(\omega, \hat{H}^{(s)}, T, \gamma^{(s)})$\;
    
    é€éç‡è¨ˆç®—: $T^{(s)}(\omega) = \text{calculate\_transmission}(\omega, \chi^{(s)}, \varepsilon^{(s)})$\;
}

\Return{$\{T^{(s)}(\omega_i)\}_{s,i}$}
\caption{é€éã‚¹ãƒšã‚¯ãƒˆãƒ«ã®äº‹å¾Œã‚µãƒ³ãƒ—ãƒ«è¨ˆç®—}
\end{algorithm}

\subsection{çµ±è¨ˆé‡ã®è¨ˆç®—}

å„å‘¨æ³¢æ•°ç‚¹$\omega_i$ã«ãŠã„ã¦ï¼š

\begin{align}
\text{äº‹å¾Œå¹³å‡}: \quad & \bar{T}(\omega_i) = \frac{1}{N} \sum_{s=1}^{N} T^{(s)}(\omega_i) \\
\text{æ¨™æº–åå·®}: \quad & \text{SD}(\omega_i) = \sqrt{\frac{1}{N-1} \sum_{s=1}^{N} (T^{(s)}(\omega_i) - \bar{T}(\omega_i))^2} \\
\text{HDIä¸‹é™}: \quad & T_{2.5\%}(\omega_i) = \text{percentile}(\{T^{(s)}(\omega_i)\}, 2.5) \\
\text{HDIä¸Šé™}: \quad & T_{97.5\%}(\omega_i) = \text{percentile}(\{T^{(s)}(\omega_i)\}, 97.5) \\
\text{HDIå¹…}: \quad & \Delta T(\omega_i) = T_{97.5\%}(\omega_i) - T_{2.5\%}(\omega_i)
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{ç”Ÿæˆã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒƒãƒˆ}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«: \texttt{plots/hdi\_test\_diagnostic.png}

\subsection{4ãƒ‘ãƒãƒ«æ§‹æˆ}

\begin{enumerate}
    \item \textbf{å…¨ä½“å›³}ï¼ˆå·¦ä¸Šï¼‰
    \begin{itemize}
        \item ãƒ‡ãƒ¼ã‚¿ç‚¹ï¼ˆç°è‰²â—‹ï¼‰
        \item 95\% HDIå¸¯ï¼ˆè–„èµ¤ã®å¡—ã‚Šã¤ã¶ã—ï¼‰
        \item HDIä¸‹é™ãƒ»ä¸Šé™ï¼ˆèµ¤ç ´ç·šï¼‰
        \item äº‹å¾Œå¹³å‡ï¼ˆæ¿ƒèµ¤å®Ÿç·šï¼‰
    \end{itemize}
    
    \item \textbf{HDIå¹…ã®å‘¨æ³¢æ•°ä¾å­˜æ€§}ï¼ˆå³ä¸Šï¼‰
    \begin{itemize}
        \item $\Delta T(\omega)$ vs $\omega$
        \item å¹³å‡HDIå¹…ã‚’èµ¤ç ´ç·šã§è¡¨ç¤º
    \end{itemize}
    
    \item \textbf{æ¨™æº–åå·®ã®å‘¨æ³¢æ•°ä¾å­˜æ€§}ï¼ˆå·¦ä¸‹ï¼‰
    \begin{itemize}
        \item SD$(\omega)$ vs $\omega$
        \item å¹³å‡SDã‚’èµ¤ç ´ç·šã§è¡¨ç¤º
    \end{itemize}
    
    \item \textbf{æ‹¡å¤§å›³}ï¼ˆå³ä¸‹ï¼‰
    \begin{itemize}
        \item 0.25ã€œ0.35 THzé ˜åŸŸã‚’æ‹¡å¤§
        \item HDIå¢ƒç•Œç·šã®è¦–èªæ€§ç¢ºèª
    \end{itemize}
\end{enumerate}

\begin{figure}[h]
\centering
\begin{tikzpicture}[scale=0.6]
% 4ãƒ‘ãƒãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
\draw[thick] (0,0) rectangle (6,4);
\draw[thick] (7,0) rectangle (13,4);
\draw[thick] (0,-5) rectangle (6,-1);
\draw[thick] (7,-5) rectangle (13,-1);

% ãƒ©ãƒ™ãƒ«
\node at (3,3.5) {\small \textbf{å…¨ä½“å›³}};
\node at (10,3.5) {\small \textbf{HDIå¹…}};
\node at (3,-1.5) {\small \textbf{æ¨™æº–åå·®}};
\node at (10,-1.5) {\small \textbf{æ‹¡å¤§å›³}};

% ç°¡æ˜“çš„ãªå›³ç¤º
% å…¨ä½“å›³
\draw[gray!50] (0.5,1) -- (5.5,1);
\fill[red!20] (0.5,1.5) -- (5.5,1.8) -- (5.5,2.2) -- (0.5,2.5) -- cycle;
\draw[red, dashed] (0.5,1.5) -- (5.5,1.8);
\draw[red, dashed] (0.5,2.5) -- (5.5,2.2);
\draw[darkgray, thick] (0.5,2) -- (5.5,2);

% HDIå¹…
\draw[blue] (7.5,2) sin (8.5,2.5) cos (9.5,2) sin (10.5,2.5) cos (11.5,2) sin (12.5,2.5);
\draw[red, dashed] (7.5,2.2) -- (12.5,2.2);

% æ¨™æº–åå·®
\draw[green!60!black] (0.5,-3) sin (1.5,-2.5) cos (2.5,-3) sin (3.5,-2.5) cos (4.5,-3) sin (5.5,-2.5);
\draw[red, dashed] (0.5,-2.8) -- (5.5,-2.8);

% æ‹¡å¤§å›³
\fill[red!20] (7.5,-2.5) rectangle (12.5,-3.5);
\draw[red, dashed, thick] (7.5,-2.5) -- (12.5,-2.5);
\draw[red, dashed, thick] (7.5,-3.5) -- (12.5,-3.5);
\draw[darkgray, thick] (7.5,-3) -- (12.5,-3);

\end{tikzpicture}
\caption{ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒƒãƒˆã®4ãƒ‘ãƒãƒ«æ§‹æˆ}
\label{fig:panels}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{è¨ºæ–­çµæœã®è§£é‡ˆ}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{æ­£å¸¸ãªå ´åˆ}

\begin{lstlisting}
ğŸ” è¨ºæ–­çµæœ
======================================================================
âœ… HDIåŒºé–“ã¯æ­£ã—ãè¨ˆç®—ã•ã‚Œã¦ã„ã¾ã™
âœ… ç ´ç·šã¯æç”»ã•ã‚Œã¦ã„ã¾ã™ãŒã€HDIå¹…ãŒéå¸¸ã«ç‹­ã„ãŸã‚
   å¹³å‡å€¤ã®ç·šã¨é‡ãªã£ã¦è¦‹ãˆã«ãã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™
\end{lstlisting}

ã“ã®å ´åˆã€è¨ˆç®—ã¯æ­£ã—ãè¡Œã‚ã‚Œã¦ãŠã‚Šã€HDIå¹…ãŒç‹­ã„ã®ã¯
äº‹å¾Œåˆ†å¸ƒã®åˆ†æ•£ãŒå°ã•ã„ãŸã‚ã§ã™ã€‚ç‰©ç†çš„ã«æ„å‘³ãŒã‚ã‚‹çµæœã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

\subsection{å•é¡ŒãŒã‚ã‚‹å ´åˆ}

\begin{lstlisting}
ğŸ” è¨ºæ–­çµæœ
======================================================================
âš ï¸ HDIå¹…ãŒæ¥µç«¯ã«ç‹­ã„ï¼ˆå¹³å‡ < 0.001ï¼‰
   â†’ äº‹å¾Œåˆ†å¸ƒã®åˆ†æ•£ãŒå°ã•ã™ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™
   â†’ äº‹å‰åˆ†å¸ƒãŒç‹­ã™ãã‚‹ã‹ã€ãƒ‡ãƒ¼ã‚¿ã®æƒ…å ±é‡ãŒå¼·ã™ãã‚‹å¯èƒ½æ€§
âš ï¸ æ¨™æº–åå·®ãŒæ¥µç«¯ã«å°ã•ã„ï¼ˆå¹³å‡ < 0.001ï¼‰
   â†’ ã‚µãƒ³ãƒ—ãƒ«é–“ã®æºã‚‰ããŒã»ã¨ã‚“ã©ãªã„

å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ:
  âš ï¸ HDIå¹…ãŒæ¥µç«¯ã«ç‹­ã„ï¼ˆå¹³å‡ < 0.001ï¼‰
  âš ï¸ æ¨™æº–åå·®ãŒæ¥µç«¯ã«å°ã•ã„ï¼ˆå¹³å‡ < 0.001ï¼‰
\end{lstlisting}

\subsection{æ¨å¥¨äº‹é …}

å•é¡ŒãŒã‚ã‚‹å ´åˆã®å¯¾å‡¦æ³•ï¼š

\begin{enumerate}
    \item \textbf{äº‹å‰åˆ†å¸ƒã®$\sigma$ã‚’æ‹¡å¤§}ï¼ˆ3ã€œ5å€ï¼‰
    \begin{lstlisting}[language=Python]
# å¤‰æ›´å‰
sigma=0.05
# å¤‰æ›´å¾Œ
sigma=0.15  # 3å€ã«æ‹¡å¤§
    \end{lstlisting}
    
    \item \textbf{ã‚µãƒ³ãƒ—ãƒ«æ•°ã‚’å¢—åŠ }
    \begin{lstlisting}[language=Python]
# å¤‰æ›´å‰
n_samples=100
# å¤‰æ›´å¾Œ
n_samples=500  # 5å€ã«å¢—åŠ 
    \end{lstlisting}
    
    \item \textbf{ãƒ—ãƒ­ãƒƒãƒˆã®ç·šå¹…ã‚’å¢—åŠ }
    \begin{lstlisting}[language=Python]
# å¤‰æ›´å‰
linewidth=2.0
# å¤‰æ›´å¾Œ
linewidth=3.0
    \end{lstlisting}
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{ä¸»è¦é–¢æ•°ã®èª¬æ˜}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{calculate\_transmission\_for\_params}

\begin{lstlisting}[language=Python]
def calculate_transmission_for_params(freq, B, T, g, a, B4, B6, 
                                       eps, gamma_array, model_form='H'):
    """
    æŒ‡å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§é€éã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—
    
    Parameters
    ----------
    freq : array
        å‘¨æ³¢æ•°é…åˆ— [THz]
    B : float
        ç£å ´ [T]
    T : float
        æ¸©åº¦ [K]
    g, a, B4, B6, eps : float
        ç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    gamma_array : array
        7å€‹ã®ç·©å’Œç‡ [THz]
    model_form : str
        'H' ã¾ãŸã¯ 'B'
    
    Returns
    -------
    trans : array
        é€éç‡é…åˆ—
    """
\end{lstlisting}

\subsection{test\_hdi\_calculation}

\begin{lstlisting}[language=Python]
def test_hdi_calculation(results_dir, n_samples=100):
    """
    HDIåŒºé–“ã®è¨ˆç®—ã¨çµ±è¨ˆã‚’ç¢ºèª
    
    å‡¦ç†å†…å®¹:
    1. ãƒˆãƒ¬ãƒ¼ã‚¹èª­ã¿è¾¼ã¿
    2. äº‹å¾Œã‚µãƒ³ãƒ—ãƒ«å–å¾—
    3. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿çµ±è¨ˆè¡¨ç¤º
    4. é€éã‚¹ãƒšã‚¯ãƒˆãƒ«è¨ˆç®—ï¼ˆå„ã‚µãƒ³ãƒ—ãƒ«ï¼‰
    5. çµ±è¨ˆé‡è¨ˆç®—ï¼ˆå¹³å‡ã€SDã€HDIï¼‰
    6. è¨ºæ–­åˆ¤å®š
    7. ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒƒãƒˆç”Ÿæˆ
    
    å‡ºåŠ›:
    - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¸ã®è¨ºæ–­çµæœ
    - plots/hdi_test_diagnostic.png
    """
\end{lstlisting}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{ã¾ã¨ã‚}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{enumerate}
    \item \textbf{ç›®çš„}ï¼šHDIä¿¡é ¼åŒºé–“ã®è¨ˆç®—ãƒ»æç”»ãŒæ­£ã—ã„ã‹ã‚’è¨ºæ–­
    
    \item \textbf{è¨ºæ–­é …ç›®}ï¼š
    \begin{itemize}
        \item HDIå¹…ã®çµ±è¨ˆï¼ˆæœ€å°ã€æœ€å¤§ã€å¹³å‡ï¼‰
        \item æ¨™æº–åå·®ã®çµ±è¨ˆ
        \item ç‰¹å®šå‘¨æ³¢æ•°ç‚¹ã§ã®ã‚µãƒ³ãƒ—ãƒ«åˆ†å¸ƒ
    \end{itemize}
    
    \item \textbf{å‡ºåŠ›}ï¼š
    \begin{itemize}
        \item 4ãƒ‘ãƒãƒ«è¨ºæ–­ãƒ—ãƒ­ãƒƒãƒˆ
        \item ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¨ºæ–­ãƒ¬ãƒãƒ¼ãƒˆ
    \end{itemize}
    
    \item \textbf{å…¸å‹çš„ãªå•é¡Œã¨å¯¾å‡¦}ï¼š
    \begin{itemize}
        \item HDIå¹…ãŒç‹­ã™ãã‚‹ â†’ äº‹å‰åˆ†å¸ƒ$\sigma$ã‚’æ‹¡å¤§
        \item å¢ƒç•Œç·šãŒè¦‹ãˆãªã„ â†’ ç·šå¹…ã‚’å¢—åŠ 
    \end{itemize}
\end{enumerate}

\begin{keypoint}
HDIä¿¡é ¼åŒºé–“ã¯ã€ãƒ™ã‚¤ã‚ºæ¨å®šã®é‡è¦ãªæˆæœç‰©ã§ã™ã€‚
å¯è¦–åŒ–ã«å•é¡ŒãŒã‚ã‚‹å ´åˆã¯ã€ã“ã®ãƒ„ãƒ¼ãƒ«ã§åŸå› ã‚’ç‰¹å®šã—ã€
é©åˆ‡ãªå¯¾å‡¦ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚
\end{keypoint}

\end{document}
